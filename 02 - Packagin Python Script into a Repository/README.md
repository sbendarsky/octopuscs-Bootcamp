# Introduction 

In this article, you’ll discover how to streamline the distribution of your Python programs using the Red Hat Package Manager (RPM) and Dandified YUM (DNF). By leveraging RPM and DNF, we’ll transform your Python script into an easily downloadable package, making deployment across Red Hat-based systems a breeze

---

### Backup Python Script

In this guide, we’ll create a simple Python script. Our Python script is a backup script that reads a configuration file with the extension .conf. This configuration file contains a list of files we want to back up. When we run the script, it will read this configuration file and save the specified files into a directory named “backup”. Additionally, each file will be saved with a timestamp added to its name, allowing us to keep track of when the backup was made (and we are going to make the script run every hour at minute 0 with crontab)

> Quick Tip: Use the “Remote – SSH” extension in Visual Studio Code (VSCode) to connect to remote machines directly from your editor

![code](../resources/Packagin%20Python%20Script%20into%20a%20Repository/apppython.png)

access crontab by using: crontab -e
the following running the script at minute zero

### Packaging Our Scirpt

In this guide, we’ll start by installing some relevant packages and setting up a directory structure that we’ll use for packaging our own script

```
sudo dnf install -y rpmdevtools rpmlint rpmdev-setuptree
```

After the installation is complete, we’ll set up the directory structure by running
```
rpmdev-setuptree 
```
check if everything worked correctly by running: tree ~/rpmbuild
You should see a tree structure with empty directories similar to the screenshot below

![tree](../resources/Packagin%20Python%20Script%20into%20a%20Repository/treerpm.png)

This directory structure provides a framework for building RPM packages. We’ll use it to organize our script and any related files before creating our own RPM package. Let’s proceed with building our backup script

Great! Now that we have our Python script (sb-backup.py) and configuration file (sb-backup.conf) ready, let’s organize them into a folder named sb-backup-1.0 and package them using tar. Then, we’ll move the packaged file to the SOURCES directory within our RPM build tree.

Here are the commands to accomplish this
```
mkdir sb-backup-1.0
mv sb-backup.conf sb-backup.py sb-backup-1.0
tar --create --file sb-backup-1.0.tar.gz sb-backup-1.0
mv sb-backup-1.0.tar.gz ~/rpmbuild/SOURCES
```
Now, we need to create a spec file (sb-backup.spec) in the SPECS directory of our RPM build tree. We’ll use this spec file to define how our RPM package should be built
This process allows you to create a custom RPM package containing your Python script and configuration file, making it easy to distribute and install on other systems

![rpm](../resources/Packagin%20Python%20Script%20into%20a%20Repository/rpmbuild.png)

and run rpmbuild -bb sb-backup.spec to build the package

Congrats! You’ve successfully built a rpm package

![rpmbuilt](../resources/Packagin%20Python%20Script%20into%20a%20Repository/rpm.png)

### Creating a Repository
in this section we are going to create a repository for our rpm package and serve it with nginx so everyone in your network can download your package

First, we’ll begin by installing the createrepo package, which will allow us to create and maintain our repository:
```
sudo dnf install createrepo
```
Next, we’ll create a directory under /usr/share/nginx/html/repos to serve as our repository directory. This directory will contain our RPM package and metadata generated by
```
createrepo
```
Now, let’s copy our RPM package into the repository directory. Assuming your RPM package file is named sb-backup-1.0.rpm, you can use the cp command to copy it

![repo](../resources/Packagin%20Python%20Script%20into%20a%20Repository/copying.png)

Setting up permissions to expose the repo to the network

![repo](../resources/Packagin%20Python%20Script%20into%20a%20Repository/firewall.png)

Creating a new configuration file in Nginx and adding a server block configuration, then restarting the Nginx service

![repo](../resources/Packagin%20Python%20Script%20into%20a%20Repository/startingnginx.png)
![repo](../resources/Packagin%20Python%20Script%20into%20a%20Repository/nginx.png)

Now, we need to add a new repository in the /etc/yum.repos.d directory

![repo](../resources/Packagin%20Python%20Script%20into%20a%20Repository/yumrepo.png)

### We've Done It
Once our package is ready, we can share it with other clients in the same network by configuring their repository settings. This involves adding a new .repo file with the baseurl parameter pointing to the location where our package is hosted, such as an Nginx file share

After configuring the repository settings, users can install our package by running the following command
```
sudo dnf install sb-backup
```
![installing](../resources/Packagin%20Python%20Script%20into%20a%20Repository/installapp.png)
